diff a/arch/arm/mach-tegra/powergate.c b/arch/arm/mach-tegra/powergate.c	(rejected hunks)
@@ -30,6 +30,7 @@
 #include <linux/seq_file.h>
 #include <linux/spinlock.h>
 #include <trace/events/power.h>
+#include <asm/atomic.h>
 
 #include <mach/clk.h>
 #include <mach/iomap.h>
@@ -1127,6 +1128,11 @@ static bool skip_pg_check(int id, bool is_unpowergate)
 }
 #endif
 
+#if !defined(CONFIG_ARCH_TEGRA_2x_SOC) && !defined(CONFIG_ARCH_TEGRA_3x_SOC)
+static atomic_t ref_count_a = ATOMIC_INIT(1); /* for TEGRA_POWERGATE_DISA */
+static atomic_t ref_count_b = ATOMIC_INIT(1); /* for TEGRA_POWERGATE_DISB */
+#endif
+
 /*
  * Must be called with clk disabled, and returns with clk disabled
  * Drivers should enable clks for partition. Unpowergates only the
